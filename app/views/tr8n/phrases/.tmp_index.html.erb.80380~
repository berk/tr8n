<%= render :partial => "/tr8n/common/header" %>
<%= render :partial => "breadcrumb" %>

<div style="background:#EFF8FF; border: 1px dotted #ccc; padding:10px;">
  <% form_tag({:action => :index}, {:method => :get, :id => "translations_search_form"}) do %>
     <%=hidden_field_tag(:section_key, @section_key) %>
	   <table>
	   	<tr>
				<td><%=text_field_tag(:search, params[:search], {:style => "width:800px;height:20px;font-size:14px;"})%></td>
				<td>
			    <button type="submit" class="translator_btn translator_small_btn" onClick="$('translations_search_form').submit(); return false;">
			        <span><%=trl("Search")%></span>
			    </button>
				</td>
	   	</tr>
			<tr>
				<td>
          <%=trl("Show")%>
          <%=select_tag(:with_translations, options_for_select([["phrases with or without translations", "any"], ["phrases with translations", "with"], ["phrases without translations", "without"], ["approved phrases with translations", "approved"]], params[:with_translations]), :onChange => "toggleFilterOptions()")%>
					<span id="extended_filter_options" style="<%='display:none' unless ['with', 'approved'].include?(params[:with_translations]) %>">
						<%=trl("submitted by")%>
	          <%=select_tag(:submitted_by, options_for_select([["anyone", "anyone"], ["me", "me"]], params[:submitted_by]))%>
						<%=trl("created on")%>
				    <%=select_tag(:submitted_on, options_for_select([["any date", "any"], ["today", "today"], ["yesterday", "yesterday"], ["in the last week", "last_week"]], params[:submitted_on]))%>
            <%=trl("with")%>
            <%=select_tag(:ranked_at, options_for_select([["any rank", "any"], ["rank < 0", "below_zero"], ["rank > 0", "above_zero"], ["rank > 5", "above_five"], ["rank > 10", "above_ten"]], params[:ranked_at]))%>
					</span>
				</td>
			</tr>
	   </table>
  <% end %>
</div>

<div style="margin-top:10px; margin-bottom:10px; border: 1px dotted #ccc; padding:10px;">

  <div style="padding-top:10px;padding-bottom:10px;">
    <table style="width:100%;">
      <tr>
        <td align='left'><%= will_paginate(@translation_keys, :skip_decorations => true) %></td>
        <td align='right'><%= page_entries_info(@translation_keys, :skip_decorations => true, :entry_name => "phrase") %></td>
      </tr>
    </table>
  </div>
  
  <table style="width:100%">
    <tr style="border-bottom:2px solid #ccc;">
       <td style="width:30%;padding:5px; background: #f9f8f7; font-size:16px; color:grey; "><%=trl("English Label / Description")%></td>
       <td style="width:70%;padding:5px; font-size:16px; color:grey; " colspan="2"><%=trl("Top #{tr8n_current_language.english_name} Translations") %></td>
    </tr>  
    <% @translation_keys.each do |tk| %>
      <tr style="border-bottom:1px solid #ccc;">
        <td style="padding:5px; background: #f9f8f7;">
          <%=link_to(tr8n_current_language.translate(tk.label, tk.description, {}, {:default_label => true}), :action => :key, :translation_key_id => tk.id, :section_key => @section_key)%>
          <div style="color:grey;font-size:10px;padding-top:3px;"><%=tk.description%></div>
        </td>
        <td style="padding:5px; vertical-align:top">
          <div id="translation_votes_for_<%=tk.key%>">
            <%= render :partial => "/tr8n/common/translation_votes", :locals => {:translation_key => tk, :translations => tk.translations_for(tr8n_current_language)[0..4], :section_key => @section_key} %>
          </div>  
        </td>
        <td style="padding-right:5px; padding-top:5px; vertical-align:top; width:10px;text-align:right">
          <%=link_to(image_tag("/tr8n/images/table_edit.png"), :action => :key, :translation_key_id => tk.id, :section_key => @section_key)%>
        </td>
      </tr>
    <% end %>
  </table>
  
  <div style="padding-top:10px;padding-bottom:10px;">
    <table style="width:100%;">
      <tr>
        <td align='left'><%= will_paginate(@translation_keys, :skip_decorations => true) %></td>
        <td align='right'><%= page_entries_info(@translation_keys, :skip_decorations => true) %></td>
      </tr>
    </table>
  </div>
  
</div>
<%= render :partial => "/tr8n/common/footer" %>

<script>
	function toggleFilterOptions() {
		if ($("with_translations").value == "with" || $("with_translations").value == "approved") {
			$("extended_filter_options").show();
		} else {
			$("extended_filter_options").hide();
		}
	}
</script>
